# Sparkle Note é¡¹ç›®å®Œæ•´è®¾è®¡æ–‡æ¡£

## ğŸ“– ç›®å½•

1. [é¡¹ç›®æ¦‚è§ˆ](#1-é¡¹ç›®æ¦‚è§ˆ)
2. [æŠ€æœ¯æ¶æ„è¯¦è§£](#2-æŠ€æœ¯æ¶æ„è¯¦è§£)
3. [UIè®¾è®¡æ–‡æ¡£](#3-uiè®¾è®¡æ–‡æ¡£)
4. [æ•°æ®æ¨¡å‹å’Œæ¥å£å®šä¹‰](#4-æ•°æ®æ¨¡å‹å’Œæ¥å£å®šä¹‰)
5. [æ ¸å¿ƒåŠŸèƒ½å®ç°](#5-æ ¸å¿ƒåŠŸèƒ½å®ç°)
6. [å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µ](#6-å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µ)
7. [éƒ¨ç½²å’Œå‘å¸ƒ](#7-éƒ¨ç½²å’Œå‘å¸ƒ)

---

## 1. é¡¹ç›®æ¦‚è§ˆ

### 1.1 é¡¹ç›®èƒŒæ™¯å’Œç›®æ ‡

**Sparkle Note** æ˜¯ä¸€æ¬¾ç°ä»£åŒ–çš„çµæ„Ÿè®°å½•åº”ç”¨ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ•æ‰å’Œç®¡ç†æ—¥å¸¸çµæ„Ÿã€‚é¡¹ç›®é‡‡ç”¨æœ€æ–°çš„ Android å¼€å‘æŠ€æœ¯æ ˆï¼Œæä¾›ä¼˜é›…çš„ç”¨æˆ·ä½“éªŒå’Œå¼ºå¤§çš„åŠŸèƒ½ç‰¹æ€§ã€‚

**æ ¸å¿ƒç›®æ ‡ï¼š**
- æä¾›å¿«é€Ÿã€ä¾¿æ·çš„çµæ„Ÿè®°å½•ä½“éªŒ
- æ”¯æŒå¤šä¸»é¢˜åˆ†ç±»ç®¡ç†
- å®ç°æ™ºèƒ½æœç´¢å’Œç­›é€‰åŠŸèƒ½
- æä¾›æ•°æ®å¤‡ä»½å’Œå¯¼å‡ºåŠŸèƒ½
- æ‰“é€ ç°ä»£åŒ–çš„ç”¨æˆ·ç•Œé¢

### 1.2 æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

| åŠŸèƒ½æ¨¡å— | ç‰¹æ€§æè¿° |
|---------|---------|
| ğŸ“ çµæ„Ÿè®°å½• | å¿«é€Ÿè¾“å…¥ã€ä¸»é¢˜åˆ†ç±»ã€å­—ç¬¦è®¡æ•°ã€è‡ªåŠ¨ä¿å­˜ |
| ğŸ¨ ä¸»é¢˜ç®¡ç† | ä¸»é¢˜CRUDã€åŠ¨æ€åŠ è½½ã€ä¸»é¢˜ç»Ÿè®¡ã€é¢œè‰²æ ‡è¯† |
| ğŸ” æ™ºèƒ½æœç´¢ | æ¨¡ç³Šæœç´¢ã€å¤šä¸»é¢˜ç­›é€‰ã€æ—¶é—´è¿‡æ»¤ã€æœç´¢å†å² |
| ğŸ“¦ æ‰¹é‡æ“ä½œ | å¤šé€‰æ“ä½œã€æ‰¹é‡å¯¼å‡ºã€æ‰¹é‡åˆ é™¤ã€æ ¼å¼è½¬æ¢ |
| ğŸ’¾ æ•°æ®å¤‡ä»½ | JSONå¤‡ä»½ã€Markdownå¯¼å‡ºã€CSVå¯¼å‡ºã€ç‰ˆæœ¬æ§åˆ¶ |
| ğŸŒ™ ä¸»é¢˜ç³»ç»Ÿ | 4ç§å†…ç½®ä¸»é¢˜ã€æ·±è‰²æ¨¡å¼ã€åŠ¨æ€åˆ‡æ¢ã€ä¸ªæ€§åŒ–å®šåˆ¶ |

### 1.3 æŠ€æœ¯æ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         UI Layer (Compose)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Presentation Layer (MVVM)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Domain Layer               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Data Layer                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 å¼€å‘ç¯å¢ƒè¦æ±‚

- **å¼€å‘è¯­è¨€**ï¼šKotlin 1.9.23
- **ç›®æ ‡å¹³å°**ï¼šAndroid 7.0+ (API 24+)
- **æ„å»ºå·¥å…·**ï¼šGradle 8.0+
- **IDE**ï¼šAndroid Studio Hedgehog æˆ–æ›´é«˜ç‰ˆæœ¬
- **JDK**ï¼š17

---

## 2. æŠ€æœ¯æ¶æ„è¯¦è§£

### 2.1 ä»£ç ç»“æ„åˆ†æ

```
com.sparkle.note/
â”œâ”€â”€ SparkleNoteApplication.kt     # åº”ç”¨å…¥å£
â”œâ”€â”€ MainActivity.kt              # ä¸»æ´»åŠ¨
â”œâ”€â”€ data/                        # æ•°æ®å±‚
â”‚   â”œâ”€â”€ database/               # æ•°æ®åº“
â”‚   â”œâ”€â”€ entity/                 # æ•°æ®å®ä½“
â”‚   â””â”€â”€ repository/            # ä»“åº“å®ç°
â”œâ”€â”€ domain/                      # é¢†åŸŸå±‚
â”‚   â”œâ”€â”€ model/                  # é¢†åŸŸæ¨¡å‹
â”‚   â””â”€â”€ repository/             # ä»“åº“æ¥å£
â”œâ”€â”€ ui/                          # UIå±‚
â”‚   â”œâ”€â”€ components/            # UIç»„ä»¶
â”‚   â”œâ”€â”€ screens/               # å±å¹•é¡µé¢
â”‚   â”œâ”€â”€ navigation/            # å¯¼èˆªé…ç½®
â”‚   â””â”€â”€ theme/                 # ä¸»é¢˜ç³»ç»Ÿ
â””â”€â”€ utils/                     # å·¥å…·ç±»
```

### 2.2 æŠ€æœ¯æ ˆè¯¦ç»†åˆ—è¡¨

#### æ ¸å¿ƒæŠ€æœ¯
- **Kotlin 1.9.23** - ä¸»è¦å¼€å‘è¯­è¨€
- **Android SDK 34** - ç›®æ ‡å¹³å°
- **Jetpack Compose BOM 2024.02.00** - UIæ¡†æ¶
- **Material3** - è®¾è®¡ç³»ç»Ÿ
- **Room 2.6.1** - æ•°æ®åº“ORM
- **Dagger Hilt 2.50** - ä¾èµ–æ³¨å…¥
- **Kotlin Coroutines 1.8.0** - å¼‚æ­¥ç¼–ç¨‹

#### è¾…åŠ©åº“
- **DataStore 1.0.0** - æ•°æ®æŒä¹…åŒ–
- **Compose Navigation** - å¯¼èˆªç®¡ç†
- **Kotlin Serialization 1.6.3** - JSONåºåˆ—åŒ–

#### æµ‹è¯•æ¡†æ¶
- **JUnit 4/5** - å•å…ƒæµ‹è¯•
- **Truth 1.4.2** - æ–­è¨€åº“
- **Turbine 1.0.0** - Flowæµ‹è¯•
- **Mockito Kotlin 5.2.1** - Mockæ¡†æ¶

### 2.3 æ¶æ„æ¨¡å¼å®ç°

#### Clean Architecture åˆ†å±‚

1. **Presentation Layer**
   - Compose UIç»„ä»¶
   - ViewModelçŠ¶æ€ç®¡ç†
   - UIçŠ¶æ€æ¨¡å‹

2. **Domain Layer**
   - ä¸šåŠ¡é€»è¾‘å°è£…
   - é¢†åŸŸæ¨¡å‹å®šä¹‰
   - ä»“åº“æ¥å£å¥‘çº¦

3. **Data Layer**
   - Roomæ•°æ®åº“
   - æ•°æ®å®ä½“æ˜ å°„
   - ä»“åº“æ¥å£å®ç°

#### MVVM æ¨¡å¼

```kotlin
@HiltViewModel
class MainViewModel @Inject constructor(
    private val repository: InspirationRepository
) : ViewModel() {
    
    private val _uiState = MutableStateFlow(MainUiState())
    val uiState: StateFlow<MainUiState> = _uiState.asStateFlow()
    
    fun addInspiration(content: String, theme: Theme) {
        viewModelScope.launch {
            val inspiration = Inspiration(
                content = content,
                themeName = theme.name
            )
            repository.insertInspiration(inspiration)
        }
    }
}
```

### 2.4 ä¾èµ–æ³¨å…¥è®¾è®¡

#### Hilt æ¨¡å—é…ç½®

```kotlin
@Module
@InstallIn(SingletonComponent::class)
object DatabaseModule {
    
    @Provides
    @Singleton
    fun provideInspirationDatabase(@ApplicationContext context: Context): InspirationDatabase {
        return Room.databaseBuilder(
            context,
            InspirationDatabase::class.java,
            "inspiration_database"
        ).build()
    }
    
    @Provides
    @Singleton
    fun provideInspirationDao(database: InspirationDatabase): InspirationDao {
        return database.inspirationDao()
    }
}

@Module
@InstallIn(SingletonComponent::class)
abstract class RepositoryModule {
    
    @Binds
    @Singleton
    abstract fun bindInspirationRepository(
        inspirationRepositoryImpl: InspirationRepositoryImpl
    ): InspirationRepository
}
```

### 2.5 çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ

#### å¤šå±‚çŠ¶æ€æ¶æ„

```kotlin
// UIå±‚çŠ¶æ€
@Composable
fun InspirationCard(inspiration: Inspiration) {
    var expanded by remember { mutableStateOf(false) }
    // ç»„ä»¶çº§çŠ¶æ€
}

// ViewModelçŠ¶æ€
class MainViewModel : ViewModel() {
    private val _uiState = MutableStateFlow(MainUiState())
    val uiState: StateFlow<MainUiState> = _uiState.asStateFlow()
    
    private val _events = MutableSharedFlow<MainEvent>()
    val events: SharedFlow<MainEvent> = _events.asSharedFlow()
}

// æ•°æ®å±‚çŠ¶æ€
@Dao
interface InspirationDao {
    @Query("SELECT * FROM inspirations")
    fun getAllInspirations(): Flow<List<InspirationEntity>>
}
```

### 2.6 æ•°æ®æµè®¾è®¡

#### å“åº”å¼æ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ â†’ UIäº‹ä»¶ â†’ ViewModel â†’ Repository â†’ DAO â†’ Database
     â†‘                                                    â†“
     â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Flow â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

#### çŠ¶æ€ç»„åˆ

```kotlin
val inspirations = combine(
    repository.getAllInspirations(),
    searchQuery,
    selectedTheme
) { inspirations, query, theme ->
    filterInspirations(inspirations, query, theme)
}.stateIn(
    scope = viewModelScope,
    started = SharingStarted.WhileSubscribed(5000),
    initialValue = emptyList()
)
```

---

## 3. UIè®¾è®¡æ–‡æ¡£

### 3.1 UIç»„ä»¶åº“

#### 3.1.1 æ ¸å¿ƒåŠŸèƒ½ç»„ä»¶

**QuickRecordSection** - å¿«é€Ÿè®°å½•ç»„ä»¶
```kotlin
@Composable
fun QuickRecordSection(
    content: String,
    onContentChange: (String) -> Unit,
    selectedTheme: Theme?,
    onThemeSelect: (Theme) -> Unit,
    onSave: () -> Unit,
    themes: List<Theme>
)
```
- åŠŸèƒ½ï¼šçµæ„Ÿå†…å®¹è¾“å…¥ã€ä¸»é¢˜é€‰æ‹©ã€ä¿å­˜æ“ä½œ
- ç‰¹è‰²ï¼šå¸¦åŠ¨ç”»æ•ˆæœã€å­—ç¬¦è®¡æ•°ã€ä¸»é¢˜é€‰æ‹©å™¨é›†æˆ
- å¸ƒå±€ï¼šå¡ç‰‡å¼è®¾è®¡ï¼ŒåŒ…å«æ ‡é¢˜ã€è¾“å…¥æ¡†ã€ä¸»é¢˜é€‰æ‹©è¡Œã€ä¿å­˜æŒ‰é’®

**InspirationCard** - çµæ„Ÿå¡ç‰‡ç»„ä»¶
```kotlin
@Composable
fun InspirationCard(
    content: String,
    themeName: String,
    createdAtText: String,
    onClick: () -> Unit,
    onLongClick: () -> Unit = {}
)
```
- åŠŸèƒ½ï¼šå±•ç¤ºçµæ„Ÿå†…å®¹ã€ä¸»é¢˜ä¿¡æ¯ã€åˆ›å»ºæ—¶é—´
- ç‰¹è‰²ï¼šåŠ¨ç”»å…¥åœºæ•ˆæœã€é•¿æŒ‰èœå•ã€ä¸»é¢˜emojiæ˜¾ç¤º
- å¸ƒå±€ï¼šåœ†è§’å¡ç‰‡ï¼ŒåŒ…å«å¤´éƒ¨ä¿¡æ¯åŒºå’Œå†…å®¹åŒº

#### 3.1.2 äº¤äº’ç»„ä»¶

**EnhancedThemeSelector** - å¢å¼ºä¸»é¢˜é€‰æ‹©å™¨
```kotlin
@Composable
fun EnhancedThemeSelector(
    selectedTheme: Theme?,
    onThemeSelected: (Theme) -> Unit,
    onCreateNewTheme: (String) -> Unit
)
```
- åŠŸèƒ½ï¼šä¸»é¢˜é€‰æ‹©ã€åŠ¨æ€ä¸»é¢˜åŠ è½½ã€ä¸»é¢˜åˆ›å»º
- ç‰¹è‰²ï¼šä¸‹æ‹‰èœå•è®¾è®¡ã€å®æ—¶ä¸»é¢˜æ•°æ®ã€å¿«é€Ÿåˆ›å»ºåŠŸèƒ½

**InspirationCardLongPressMenu** - é•¿æŒ‰èœå•
```kotlin
@Composable
fun InspirationCardLongPressMenu(
    inspiration: Inspiration,
    onDismiss: () -> Unit,
    onCopyContent: () -> Unit,
    onOpenLink: (String) -> Unit
)
```
- åŠŸèƒ½ï¼šå¤åˆ¶å†…å®¹ã€æ‰“å¼€é“¾æ¥ã€å…³é—­æ“ä½œ
- ç‰¹è‰²ï¼šæ™ºèƒ½é“¾æ¥æ£€æµ‹ã€å†…å®¹é¢„è§ˆã€ä¸»é¢˜ä¿¡æ¯æ˜¾ç¤º

### 3.2 ä¸»è¦å±å¹•ç•Œé¢

#### 3.2.1 ä¸»å±å¹• (EnhancedMainScreen)

**å¸ƒå±€ç»“æ„**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¡¶éƒ¨æ“ä½œæ  (ActionBar)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  çµæ„Ÿå¡ç‰‡åˆ—è¡¨åŒºåŸŸ                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ çµæ„Ÿå¡ç‰‡1                    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ çµæ„Ÿå¡ç‰‡2                    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ...                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åº•éƒ¨å¿«é€Ÿè®°å½•åŒº (BottomQuickRecord)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è®¾è®¡ç‰¹ç‚¹**
- **ç§»åŠ¨ä¼˜å…ˆ**ï¼šåº•éƒ¨è¾“å…¥è®¾è®¡ç¬¦åˆæ‰‹æœºä½¿ç”¨ä¹ æƒ¯
- **ç©ºé—´æœ€å¤§åŒ–**ï¼šå¡ç‰‡åˆ—è¡¨å æ®ä¸»è¦ç©ºé—´
- **æ“ä½œä¾¿æ·**ï¼šå¸¸ç”¨åŠŸèƒ½ä¸€é”®å¯è¾¾
- **è§†è§‰å±‚æ¬¡**ï¼šé€šè¿‡é˜´å½±ã€é—´è·å»ºç«‹æ¸…æ™°çš„å±‚æ¬¡ç»“æ„

#### 3.2.2 é«˜çº§æœç´¢å±å¹•

**åŠŸèƒ½ç‰¹æ€§**
- å¤šå…³é”®è¯æ¨¡ç³Šæœç´¢
- å¤šä¸»é¢˜åŒæ—¶ç­›é€‰
- æ—¶é—´èŒƒå›´è¿‡æ»¤ï¼ˆä»Šå¤©/æœ¬å‘¨/æœ¬æœˆ/å…¨éƒ¨ï¼‰
- æœç´¢å†å²è®°å½•
- æœç´¢ç»“æœå®æ—¶æ˜¾ç¤º

**ç•Œé¢å¸ƒå±€**
- é¡¶éƒ¨æœç´¢æ 
- ç­›é€‰æ¡ä»¶åŒºåŸŸï¼ˆä¸»é¢˜é€‰æ‹©å™¨ã€æ—¶é—´è¿‡æ»¤å™¨ï¼‰
- æœç´¢ç»“æœåˆ—è¡¨
- ç©ºçŠ¶æ€æç¤º

#### 3.2.3 æ‰¹é‡æ“ä½œå±å¹•

**æ ¸å¿ƒåŠŸèƒ½**
- å¤šé€‰æ¨¡å¼åˆ‡æ¢
- æ‰¹é‡é€‰æ‹©/å–æ¶ˆé€‰æ‹©
- æ‰¹é‡åˆ é™¤ï¼ˆå¸¦ç¡®è®¤ï¼‰
- æ‰¹é‡å¯¼å‡ºï¼ˆMarkdown/JSON/CSVï¼‰
- æ“ä½œè¿›åº¦æ˜¾ç¤º

### 3.3 ä¸»é¢˜ç³»ç»Ÿè®¾è®¡

#### 3.3.1 å››ç§å†…ç½®ä¸»é¢˜

**1. åŒ—æ¬§é£æ ¼ (NORDIC)** - é»˜è®¤ä¸»é¢˜
- ä¸»è‰²ï¼š#4A90E2 (åŒ—æ¬§è“)
- å¼ºè°ƒè‰²ï¼š#50C878 (åŒ—æ¬§ç»¿)
- èƒŒæ™¯ï¼š#1A1A1A (æ·±ç°)
- è¡¨é¢ï¼š#2A2A2A (ä¸­ç°)

**2. æ·±é‚ƒå¤œç©º (DEEP_NIGHT)**
- ä¸»è‰²ï¼š#00D4FF (éœ“è™¹è“)
- èƒŒæ™¯ï¼š#0D0D0D (çº¯é»‘)
- è¡¨é¢ï¼š#1A1A1A (æ·±ç°)

**3. è–„è·æ™¨éœ² (MINT_MORNING)**
- ä¸»è‰²ï¼š#4ECDC4 (è–„è·ç»¿)
- èƒŒæ™¯ï¼š#F8FFFE (ææ·¡è–„è·)
- æ¸…æ–°æ˜äº®é£æ ¼

**4. å­¦é™¢è“è°ƒ (SCHOLAR_BLUE)**
- ä¸»è‰²ï¼š#2C5F8D (å­¦æœ¯è“)
- è¾…åŠ©è‰²ï¼š#8B4513 (çš®é©æ£•)
- ç»å…¸å­¦æœ¯é£æ ¼

#### 3.3.2 ä¸»é¢˜ç®¡ç†æ¶æ„

```kotlin
@Composable
fun SparkleNoteTheme(
    themeStyle: ThemeStyle = ThemeStyle.NORDIC,
    darkTheme: Boolean = isSystemInDarkTheme(),
    content: @Composable () -> Unit
) {
    val colorScheme = when (themeStyle) {
        ThemeStyle.NORDIC -> if (darkTheme) NordicDarkColorScheme else NordicLightColorScheme
        // ... å…¶ä»–ä¸»é¢˜
    }
    
    MaterialTheme(
        colorScheme = colorScheme,
        typography = Typography,
        content = content
    )
}
```

### 3.4 äº¤äº’è®¾è®¡å’Œç”¨æˆ·ä½“éªŒ

#### 3.4.1 äº¤äº’æ¨¡å¼

**ä¸»è¦äº¤äº’æ–¹å¼**
1. **ç‚¹å‡»æ“ä½œ**ï¼šå¡ç‰‡å±•å¼€ã€æŒ‰é’®å“åº”
2. **é•¿æŒ‰æ“ä½œ**ï¼šä¸Šä¸‹æ–‡èœå•ã€å¤šé€‰æ¨¡å¼
3. **æ»‘åŠ¨æ“ä½œ**ï¼šåˆ—è¡¨æ»šåŠ¨ã€å¿«é€Ÿæ“ä½œ
4. **è¾“å…¥äº¤äº’**ï¼šå®æ—¶æœç´¢ã€å­—ç¬¦è®¡æ•°

**åŠ¨ç”»è®¾è®¡**
- å…¥åœºåŠ¨ç”»ï¼šç»„ä»¶åŠ è½½æ—¶çš„ç¼©æ”¾å’Œæ·¡å…¥æ•ˆæœ
- çŠ¶æ€åŠ¨ç”»ï¼šé€‰æ‹©çŠ¶æ€çš„å¹³æ»‘è¿‡æ¸¡
- åé¦ˆåŠ¨ç”»ï¼šæŒ‰é’®ç‚¹å‡»çš„è§†è§‰åé¦ˆ

#### 3.4.2 æ— éšœç¢è®¾è®¡

- **è¯­ä¹‰åŒ–å†…å®¹**ï¼šæ‰€æœ‰äº¤äº’å…ƒç´ éƒ½æœ‰æ¸…æ™°çš„å†…å®¹æè¿°
- **è§¦æ‘¸ç›®æ ‡**ï¼šæŒ‰é’®å’Œå¯ç‚¹å‡»åŒºåŸŸç¬¦åˆæœ€å°è§¦æ‘¸ç›®æ ‡è¦æ±‚ï¼ˆ48dpï¼‰
- **é«˜å¯¹æ¯”åº¦**ï¼šè‰²å½©å¯¹æ¯”åº¦ç¬¦åˆWCAGæ ‡å‡†
- **æ–‡å­—ç¼©æ”¾**ï¼šæ”¯æŒç³»ç»Ÿå­—ä½“å¤§å°è°ƒæ•´

---

## 4. æ•°æ®æ¨¡å‹å’Œæ¥å£å®šä¹‰

### 4.1 é¢†åŸŸæ¨¡å‹ (Domain Models)

#### 4.1.1 çµæ„Ÿæ¨¡å‹ (Inspiration)

```kotlin
data class Inspiration(
    val id: Long = 0,
    val content: String,
    val themeName: String,
    val createdAt: Long = System.currentTimeMillis(),
    val wordCount: Int = content.length
) {
    fun validateContent(): ValidationResult {
        return when {
            content.isBlank() -> ValidationResult.Error("å†…å®¹ä¸èƒ½ä¸ºç©º")
            content.length > 1000 -> ValidationResult.Error("å†…å®¹ä¸èƒ½è¶…è¿‡1000å­—ç¬¦")
            else -> ValidationResult.Success
        }
    }
}
```

#### 4.1.2 ä¸»é¢˜æ¨¡å‹ (Theme)

```kotlin
data class Theme(
    val name: String,
    val icon: String = "ğŸ’¡",
    val color: Long = 0xFF4A90E2,
    val description: String = "",
    val createdAt: Long = System.currentTimeMillis(),
    val lastUsed: Long = System.currentTimeMillis(),
    val inspirationCount: Int = 0
) {
    fun validateName(): ValidationResult {
        return when {
            name.isBlank() -> ValidationResult.Error("ä¸»é¢˜åç§°ä¸èƒ½ä¸ºç©º")
            name.length > 20 -> ValidationResult.Error("ä¸»é¢˜åç§°ä¸èƒ½è¶…è¿‡20å­—ç¬¦")
            else -> ValidationResult.Success
        }
    }
}
```

### 4.2 æ•°æ®å®ä½“ (Data Entities)

#### 4.2.1 çµæ„Ÿå®ä½“ (InspirationEntity)

```kotlin
@Entity(
    tableName = "inspirations",
    foreignKeys = [ForeignKey(
        entity = ThemeEntity::class,
        parentColumns = ["name"],
        childColumns = ["theme_name"],
        onDelete = ForeignKey.CASCADE,
        onUpdate = ForeignKey.CASCADE
    )],
    indices = [
        Index(value = ["content"]),
        Index(value = ["theme_name"]),
        Index(value = ["created_at"])
    ]
)
data class InspirationEntity(
    @PrimaryKey(autoGenerate = true) val id: Long = 0,
    val content: String,
    val theme_name: String,
    val created_at: Long,
    val word_count: Int
)
```

#### 4.2.2 ä¸»é¢˜å®ä½“ (ThemeEntity)

```kotlin
@Entity(tableName = "themes")
data class ThemeEntity(
    @PrimaryKey val name: String,
    val icon: String = "ğŸ’¡",
    val color: Long = 0xFF4A90E2,
    val description: String = "",
    val createdAt: Long,
    val lastUsed: Long,
    val inspirationCount: Int = 0
)
```

### 4.3 ä»“åº“æ¥å£ (Repository Interfaces)

#### 4.3.1 çµæ„Ÿä»“åº“æ¥å£

```kotlin
interface InspirationRepository {
    fun getAllInspirations(): Flow<List<Inspiration>>
    fun searchInspirations(keyword: String): Flow<List<Inspiration>>
    fun getInspirationsByTheme(themeName: String): Flow<List<Inspiration>>
    suspend fun insertInspiration(inspiration: Inspiration): Result<Unit>
    suspend fun deleteInspiration(inspiration: Inspiration): Result<Unit>
    suspend fun getInspirationById(id: Long): Inspiration?
    suspend fun getInspirationsCount(): Long
    suspend fun exportInspirationsToFile(format: String): Result<File>
    suspend fun backupData(): Result<File>
}
```

#### 4.3.2 ä¸»é¢˜ä»“åº“æ¥å£

```kotlin
interface ThemeRepository {
    fun getAllThemes(): Flow<List<Theme>>
    fun getThemesByUsage(): Flow<List<Theme>>
    suspend fun createTheme(theme: Theme): Result<Unit>
    suspend fun updateTheme(theme: Theme): Result<Unit>
    suspend fun deleteTheme(themeName: String): Result<Unit>
    suspend fun themeExists(themeName: String): Boolean
    suspend fun updateThemeLastUsed(themeName: String): Result<Unit>
}
```

### 4.4 DAOæ¥å£å®šä¹‰

#### 4.4.1 çµæ„Ÿæ•°æ®è®¿é—®å¯¹è±¡

```kotlin
@Dao
interface InspirationDao {
    @Query("SELECT * FROM inspirations ORDER BY created_at DESC")
    fun getAllInspirations(): Flow<List<InspirationEntity>>
    
    @Query("SELECT * FROM inspirations WHERE content LIKE '%' || :keyword || '%' ORDER BY created_at DESC")
    fun searchInspirations(keyword: String): Flow<List<InspirationEntity>>
    
    @Query("SELECT * FROM inspirations WHERE theme_name = :themeName ORDER BY created_at DESC")
    fun getInspirationsByTheme(themeName: String): Flow<List<InspirationEntity>>
    
    @Insert
    suspend fun insertInspiration(inspiration: InspirationEntity)
    
    @Update
    suspend fun updateInspiration(inspiration: InspirationEntity)
    
    @Delete
    suspend fun deleteInspiration(inspiration: InspirationEntity)
    
    @Query("DELETE FROM inspirations WHERE id = :id")
    suspend fun deleteById(id: Long)
    
    @Query("SELECT COUNT(*) FROM inspirations")
    suspend fun getInspirationsCount(): Long
    
    @Query("SELECT COUNT(*) FROM inspirations WHERE theme_name = :themeName")
    suspend fun getInspirationsCountByTheme(themeName: String): Long
}
```

#### 4.4.2 ä¸»é¢˜æ•°æ®è®¿é—®å¯¹è±¡

```kotlin
@Dao
interface ThemeDao {
    @Query("SELECT * FROM themes ORDER BY lastUsed DESC")
    fun getAllThemes(): Flow<List<ThemeEntity>>
    
    @Query("SELECT * FROM themes ORDER BY inspirationCount DESC")
    fun getThemesByUsage(): Flow<List<ThemeEntity>>
    
    @Insert(onConflict = OnConflictStrategy.ABORT)
    suspend fun insertTheme(theme: ThemeEntity)
    
    @Update
    suspend fun updateTheme(theme: ThemeEntity)
    
    @Delete
    suspend fun deleteTheme(theme: ThemeEntity)
    
    @Query("DELETE FROM themes WHERE name = :themeName")
    suspend fun deleteThemeByName(themeName: String)
    
    @Query("SELECT EXISTS(SELECT 1 FROM themes WHERE name = :themeName)")
    suspend fun themeExists(themeName: String): Boolean
    
    @Query("UPDATE themes SET lastUsed = :timestamp WHERE name = :themeName")
    suspend fun updateThemeLastUsed(themeName: String, timestamp: Long)
    
    @Query("UPDATE themes SET inspirationCount = :count WHERE name = :themeName")
    suspend fun updateThemeInspirationCount(themeName: String, count: Int)
}
```

### 4.5 UIçŠ¶æ€æ¨¡å‹

#### 4.5.1 ä¸»å±å¹•çŠ¶æ€

```kotlin
data class MainUiState(
    val inspirations: List<Inspiration> = emptyList(),
    val availableThemes: List<Theme> = emptyList(),
    val inputText: String = "",
    val isLoading: Boolean = false,
    val error: String? = null
)

sealed class MainEvent {
    data class ShowError(val message: String) : MainEvent()
    data class ShowDeleteSuccess(val message: String) : MainEvent()
    data class CopyToClipboard(val content: String) : MainEvent()
    data class OpenLink(val url: String) : MainEvent()
}
```

#### 4.5.2 ä¸»é¢˜ç®¡ç†çŠ¶æ€

```kotlin
data class ThemeManagementUiState(
    val themes: List<Theme> = emptyList(),
    val isLoading: Boolean = false,
    val error: String? = null,
    val showCreateDialog: Boolean = false,
    val showEditDialog: Boolean = false,
    val editingTheme: Theme? = null
)
```

### 4.6 æ•°æ®è½¬æ¢é€»è¾‘

#### 4.6.1 å®ä½“åˆ°é¢†åŸŸæ¨¡å‹è½¬æ¢

```kotlin
fun InspirationEntity.toDomain(): Inspiration {
    return Inspiration(
        id = this.id,
        content = this.content,
        themeName = this.theme_name,
        createdAt = this.created_at,
        wordCount = this.word_count
    )
}

fun ThemeEntity.toDomain(): Theme {
    return Theme(
        name = this.name,
        icon = this.icon,
        color = this.color,
        description = this.description,
        createdAt = this.createdAt,
        lastUsed = this.lastUsed,
        inspirationCount = this.inspirationCount
    )
}
```

#### 4.6.2 é¢†åŸŸæ¨¡å‹åˆ°å®ä½“è½¬æ¢

```kotlin
fun Inspiration.toEntity(): InspirationEntity {
    return InspirationEntity(
        id = this.id,
        content = this.content,
        theme_name = this.themeName,
        created_at = this.createdAt,
        word_count = this.wordCount
    )
}

fun Theme.toEntity(): ThemeEntity {
    return ThemeEntity(
        name = this.name,
        icon = this.icon,
        color = this.color,
        description = this.description,
        createdAt = this.createdAt,
        lastUsed = this.lastUsed,
        inspirationCount = this.inspirationCount
    )
}
```

---

## 5. æ ¸å¿ƒåŠŸèƒ½å®ç°

### 5.1 çµæ„Ÿè®°å½•åŠŸèƒ½

#### 5.1.1 åˆ›å»ºçµæ„Ÿæµç¨‹

```kotlin
class MainViewModel @Inject constructor(
    private val inspirationRepository: InspirationRepository,
    private val themeRepository: ThemeRepository
) : ViewModel() {
    
    fun addInspiration() {
        val content = _uiState.value.inputText.trim()
        val theme = _selectedTheme.value
        
        if (content.isBlank()) {
            _events.emit(MainEvent.ShowError("è¯·è¾“å…¥çµæ„Ÿå†…å®¹"))
            return
        }
        
        if (theme == null) {
            _events.emit(MainEvent.ShowError("è¯·é€‰æ‹©ä¸»é¢˜"))
            return
        }
        
        viewModelScope.launch {
            try {
                val inspiration = Inspiration(
                    content = content,
                    themeName = theme.name,
                    createdAt = System.currentTimeMillis()
                )
                
                val result = inspirationRepository.insertInspiration(inspiration)
                
                if (result.isSuccess) {
                    _uiState.update { it.copy(inputText = "") }
                    _events.emit(MainEvent.ShowDeleteSuccess("çµæ„Ÿå·²ä¿å­˜"))
                    // æ›´æ–°ä¸»é¢˜æœ€åä½¿ç”¨æ—¶é—´
                    themeRepository.updateThemeLastUsed(theme.name)
                } else {
                    _events.emit(MainEvent.ShowError(result.exceptionOrNull()?.message ?: "ä¿å­˜å¤±è´¥"))
                }
            } catch (e: Exception) {
                _events.emit(MainEvent.ShowError(e.message ?: "ä¿å­˜å¤±è´¥"))
            }
        }
    }
}
```

#### 5.1.2 åˆ é™¤çµæ„Ÿæµç¨‹

```kotlin
fun deleteInspiration(inspiration: Inspiration) {
    viewModelScope.launch {
        try {
            val result = inspirationRepository.deleteInspiration(inspiration)
            
            if (result.isSuccess) {
                _events.emit(MainEvent.ShowDeleteSuccess("çµæ„Ÿå·²åˆ é™¤"))
                // æ›´æ–°ä¸»é¢˜ç»Ÿè®¡ä¿¡æ¯
                themeRepository.updateThemeLastUsed(inspiration.themeName)
            } else {
                _events.emit(MainEvent.ShowError(result.exceptionOrNull()?.message ?: "åˆ é™¤å¤±è´¥"))
            }
        } catch (e: Exception) {
            _events.emit(MainEvent.ShowError(e.message ?: "åˆ é™¤å¤±è´¥"))
        }
    }
}
```

### 5.2 ä¸»é¢˜ç®¡ç†åŠŸèƒ½

#### 5.2.1 åŠ¨æ€ä¸»é¢˜åŠ è½½

```kotlin
class ThemeManagementViewModel @Inject constructor(
    private val themeRepository: ThemeRepository
) : ViewModel() {
    
    init {
        loadThemes()
    }
    
    private fun loadThemes() {
        viewModelScope.launch {
            themeRepository.getAllThemes()
                .collect { themes ->
                    _uiState.update { currentState ->
                        currentState.copy(
                            themes = themes,
                            isLoading = false
                        )
                    }
                }
        }
    }
    
    fun createTheme(themeName: String) {
        viewModelScope.launch {
            try {
                // éªŒè¯ä¸»é¢˜åç§°
                if (themeName.isBlank()) {
                    _events.emit(ThemeManagementEvent.ShowError("ä¸»é¢˜åç§°ä¸èƒ½ä¸ºç©º"))
                    return@launch
                }
                
                // æ£€æŸ¥ä¸»é¢˜æ˜¯å¦å·²å­˜åœ¨
                if (themeRepository.themeExists(themeName)) {
                    _events.emit(ThemeManagementEvent.ShowError("ä¸»é¢˜å·²å­˜åœ¨"))
                    return@launch
                }
                
                // åˆ›å»ºæ–°ä¸»é¢˜
                val newTheme = Theme(
                    name = themeName,
                    icon = "ğŸ’¡",
                    color = 0xFF4A90E2,
                    createdAt = System.currentTimeMillis(),
                    lastUsed = System.currentTimeMillis()
                )
                
                val result = themeRepository.createTheme(newTheme)
                
                if (result.isSuccess) {
                    _events.emit(ThemeManagementEvent.ShowSuccess("ä¸»é¢˜åˆ›å»ºæˆåŠŸ"))
                    hideCreateDialog()
                } else {
                    _events.emit(ThemeManagementEvent.ShowError(result.exceptionOrNull()?.message ?: "åˆ›å»ºå¤±è´¥"))
                }
            } catch (e: Exception) {
                _events.emit(ThemeManagementEvent.ShowError(e.message ?: "åˆ›å»ºå¤±è´¥"))
            }
        }
    }
}
```

### 5.3 æœç´¢åŠŸèƒ½å®ç°

#### 5.3.1 æ¨¡ç³Šæœç´¢

```kotlin
class AdvancedSearchViewModel @Inject constructor(
    private val inspirationRepository: InspirationRepository
) : ViewModel() {
    
    fun performSearch() {
        val query = _searchQuery.value.trim()
        val selectedThemes = _selectedThemes.value
        val timeFilter = _timeFilter.value
        
        if (query.isBlank() && selectedThemes.isEmpty() && timeFilter == TimeFilter.ALL) {
            // å¦‚æœæ²¡æœ‰ç­›é€‰æ¡ä»¶ï¼Œæ˜¾ç¤ºæ‰€æœ‰æ•°æ®
            loadAllInspirations()
            return
        }
        
        viewModelScope.launch {
            _uiState.update { it.copy(isLoading = true) }
            
            try {
                // ç»„åˆå¤šä¸ªæœç´¢æ¡ä»¶
                val searchFlow = combine(
                    inspirationRepository.getAllInspirations(),
                    flowOf(query),
                    flowOf(selectedThemes),
                    flowOf(timeFilter)
                ) { inspirations, query, themes, filter ->
                    filterInspirations(inspirations, query, themes, filter)
                }
                
                searchFlow.collect { filteredInspirations ->
                    _uiState.update { currentState ->
                        currentState.copy(
                            inspirations = filteredInspirations,
                            isLoading = false
                        )
                    }
                }
            } catch (e: Exception) {
                _uiState.update {
                    it.copy(
                        error = e.message ?: "æœç´¢å¤±è´¥",
                        isLoading = false
                    )
                }
            }
        }
    }
    
    private fun filterInspirations(
        inspirations: List<Inspiration>,
        query: String,
        selectedThemes: Set<String>,
        timeFilter: TimeFilter
    ): List<Inspiration> {
        return inspirations.filter { inspiration ->
            // å…³é”®è¯åŒ¹é…
            val matchesQuery = query.isBlank() || 
                inspiration.content.contains(query, ignoreCase = true)
            
            // ä¸»é¢˜åŒ¹é…
            val matchesTheme = selectedThemes.isEmpty() || 
                selectedThemes.contains(inspiration.themeName)
            
            // æ—¶é—´åŒ¹é…
            val matchesTime = when (timeFilter) {
                TimeFilter.TODAY -> isToday(inspiration.createdAt)
                TimeFilter.THIS_WEEK -> isThisWeek(inspiration.createdAt)
                TimeFilter.THIS_MONTH -> isThisMonth(inspiration.createdAt)
                TimeFilter.ALL -> true
            }
            
            matchesQuery && matchesTheme && matchesTime
        }
    }
}
```

### 5.4 æ‰¹é‡æ“ä½œåŠŸèƒ½

#### 5.4.1 å¤šé€‰æ¨¡å¼ç®¡ç†

```kotlin
class BatchOperationViewModel @Inject constructor(
    private val inspirationRepository: InspirationRepository,
    private val exportManager: ExportManager
) : ViewModel() {
    
    private val _selectedInspirations = MutableStateFlow<Set<Inspiration>>(emptySet())
    val selectedInspirations: StateFlow<Set<Inspiration>> = _selectedInspirations.asStateFlow()
    
    fun toggleInspirationSelection(inspiration: Inspiration) {
        val currentSelection = _selectedInspirations.value
        _selectedInspirations.value = if (currentSelection.contains(inspiration)) {
            currentSelection - inspiration
        } else {
            currentSelection + inspiration
        }
    }
    
    fun toggleSelectAll() {
        val allInspirations = _uiState.value.inspirations
        val currentSelection = _selectedInspirations.value
        
        _selectedInspirations.value = if (currentSelection.size == allInspirations.size) {
            emptySet()
        } else {
            allInspirations.toSet()
        }
    }
    
    fun performBatchDelete() {
        val selected = _selectedInspirations.value.toList()
        
        viewModelScope.launch {
            try {
                val results = selected.map { inspiration ->
                    inspirationRepository.deleteInspiration(inspiration)
                }
                
                val successCount = results.count { it.isSuccess }
                
                if (successCount == selected.size) {
                    _events.emit(BatchOperationEvent.ShowSuccess("æˆåŠŸåˆ é™¤ ${selected.size} æ¡çµæ„Ÿ"))
                    _selectedInspirations.value = emptySet()
                } else {
                    _events.emit(BatchOperationEvent.ShowError("éƒ¨åˆ†åˆ é™¤å¤±è´¥ï¼ŒæˆåŠŸåˆ é™¤ $successCount æ¡"))
                }
            } catch (e: Exception) {
                _events.emit(BatchOperationEvent.ShowError("æ‰¹é‡åˆ é™¤å¤±è´¥: ${e.message}"))
            }
        }
    }
}
```

### 5.5 æ•°æ®å¤‡ä»½å’Œå¯¼å‡ºåŠŸèƒ½

#### 5.5.1 Markdownå¯¼å‡º

```kotlin
object ExportManager {
    
    fun exportToMarkdown(inspirations: List<Inspiration>): String {
        val dateFormat = SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault())
        val currentTime = dateFormat.format(Date())
        
        val markdown = buildString {
            appendLine("# Sparkle Note å¯¼å‡º")
            appendLine("ç”Ÿæˆæ—¶é—´: $currentTime")
            appendLine("å¯¼å‡ºæ•°é‡: ${inspirations.size} æ¡")
            appendLine()
            
            inspirations.forEach { inspiration ->
                appendLine("## ${inspiration.themeName} ${getThemeEmoji(inspiration.themeName)}")
                appendLine("**åˆ›å»ºæ—¶é—´:** ${dateFormat.format(Date(inspiration.createdAt))}")
                appendLine("**å­—æ•°:** ${inspiration.wordCount}")
                appendLine()
                appendLine(inspiration.content)
                appendLine()
                appendLine("---")
                appendLine()
            }
        }
        
        return markdown
    }
    
    fun exportBatchToMarkdown(inspirations: List<Inspiration>): String {
        return if (inspirations.size == 1) {
            exportToMarkdown(inspirations)
        } else {
            // æŒ‰ä¸»é¢˜åˆ†ç»„å¯¼å‡º
            val groupedByTheme = inspirations.groupBy { it.themeName }
            
            buildString {
                appendLine("# Sparkle Note æ‰¹é‡å¯¼å‡º")
                appendLine("ç”Ÿæˆæ—¶é—´: ${SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault()).format(Date())}")
                appendLine("å¯¼å‡ºæ•°é‡: ${inspirations.size} æ¡")
                appendLine("æ¶‰åŠä¸»é¢˜: ${groupedByTheme.keys.size} ä¸ª")
                appendLine()
                
                groupedByTheme.forEach { (themeName, themeInspirations) ->
                    appendLine("## $themeName ${getThemeEmoji(themeName)} (${themeInspirations.size}æ¡)")
                    appendLine()
                    
                    themeInspirations.forEach { inspiration ->
                        appendLine("### ${SimpleDateFormat("MM-dd HH:mm", Locale.getDefault()).format(Date(inspiration.createdAt))}")
                        appendLine("${inspiration.content}")
                        appendLine()
                    }
                    
                    appendLine("---")
                    appendLine()
                }
            }
        }
    }
}
```

#### 5.5.2 JSONå¤‡ä»½

```kotlin
object BackupManager {
    
    @Serializable
    data class BackupData(
        val version: String = "1.0",
        val createdAt: Long,
        val inspirations: List<InspirationBackup>,
        val themes: List<ThemeBackup>,
        val metadata: BackupMetadata
    )
    
    @Serializable
    data class InspirationBackup(
        val id: Long,
        val content: String,
        val themeName: String,
        val createdAt: Long,
        val wordCount: Int
    )
    
    @Serializable
    data class ThemeBackup(
        val name: String,
        val icon: String,
        val color: Long,
        val description: String,
        val createdAt: Long,
        val lastUsed: Long,
        val inspirationCount: Int
    )
    
    @Serializable
    data class BackupMetadata(
        val appVersion: String,
        val exportFormat: String,
        val totalInspirations: Int,
        val totalThemes: Int,
        val exportTimestamp: Long
    )
    
    fun createBackup(inspirations: List<Inspiration>, themes: List<Theme>): String {
        val backupData = BackupData(
            createdAt = System.currentTimeMillis(),
            inspirations = inspirations.map { inspiration ->
                InspirationBackup(
                    id = inspiration.id,
                    content = inspiration.content,
                    themeName = inspiration.themeName,
                    createdAt = inspiration.createdAt,
                    wordCount = inspiration.wordCount
                )
            },
            themes = themes.map { theme ->
                ThemeBackup(
                    name = theme.name,
                    icon = theme.icon,
                    color = theme.color,
                    description = theme.description,
                    createdAt = theme.createdAt,
                    lastUsed = theme.lastUsed,
                    inspirationCount = theme.inspirationCount
                )
            },
            metadata = BackupMetadata(
                appVersion = BuildConfig.VERSION_NAME,
                exportFormat = "JSON",
                totalInspirations = inspirations.size,
                totalThemes = themes.size,
                exportTimestamp = System.currentTimeMillis()
            )
        )
        
        return Json.encodeToString(backupData)
    }
}
```

---

## 6. å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µ

### 6.1 ä»£ç è§„èŒƒ

#### 6.1.1 å‘½åè§„èŒƒ

**ç±»å‘½å**
- ä½¿ç”¨ PascalCase
- åç¼€æ˜ç¡®ï¼šRepository, ViewModel, Screen, Component, Dao, Entity
- ç¤ºä¾‹ï¼š`InspirationRepository`, `MainViewModel`, `EnhancedMainScreen`

**å‡½æ•°å‘½å**
- ä½¿ç”¨ camelCase
- åŠ¨è¯å¼€å¤´ï¼Œæè¿°æ¸…æ¥šåŠŸèƒ½
- ç¤ºä¾‹ï¼š`getAllInspirations()`, `performSearch()`, `toggleThemeSelection()`

**å˜é‡å‘½å**
- ä½¿ç”¨ camelCase
- é¿å…ç¼©å†™ï¼Œé™¤éæ˜¯è¡Œä¸šæ ‡å‡†
- ç¤ºä¾‹ï¼š`selectedTheme`, `searchQuery`, `inspirationCount`

#### 6.1.2 ä»£ç ç»“æ„

**æ–‡ä»¶ç»„ç»‡**
```kotlin
// 1. å¯¼å…¥è¯­å¥
import ...

// 2. ç±»/æ¥å£å®šä¹‰
class InspirationRepositoryImpl @Inject constructor(
    private val inspirationDao: InspirationDao,
    private val themeDao: ThemeDao
) : InspirationRepository {
    
    // 3. å…¬å…±å‡½æ•°ï¼ˆæŒ‰åŠŸèƒ½åˆ†ç»„ï¼‰
    override fun getAllInspirations(): Flow<List<Inspiration>> {
        // å®ç°ä»£ç 
    }
    
    // 4. ç§æœ‰å‡½æ•°
    private fun updateThemeStats(themeName: String) {
        // å®ç°ä»£ç 
    }
    
    // 5. æ‰©å±•å‡½æ•°
    private fun InspirationEntity.toDomain(): Inspiration {
        // è½¬æ¢é€»è¾‘
    }
}
```

### 6.2 æäº¤è§„èŒƒ

é¡¹ç›®é‡‡ç”¨ **Conventional Commits** è§„èŒƒï¼š

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

**æäº¤ç±»å‹**
- `feat`: æ–°åŠŸèƒ½
- `fix`: é”™è¯¯ä¿®å¤
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´
- `refactor`: ä»£ç é‡æ„
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

**ç¤ºä¾‹**
```
feat: æ·»åŠ ä¸»é¢˜ç®¡ç†åŠŸèƒ½

- å®ç°ä¸»é¢˜çš„CRUDæ“ä½œ
- æ·»åŠ ä¸»é¢˜é€‰æ‹©å™¨ç»„ä»¶
- æ”¯æŒåŠ¨æ€ä¸»é¢˜åŠ è½½

Closes #123
```

### 6.3 æµ‹è¯•ç­–ç•¥

#### 6.3.1 å•å…ƒæµ‹è¯•è¦†ç›–

**ViewModelæµ‹è¯•**
```kotlin
@Test
fun `addInspiration with valid content should succeed`() = runTest {
    // Given
    val content = "æµ‹è¯•çµæ„Ÿå†…å®¹"
    val theme = Theme("æµ‹è¯•ä¸»é¢˜")
    coEvery { repository.insertInspiration(any()) } returns Result.success(Unit)
    
    // When
    viewModel.updateInputText(content)
    viewModel.setSelectedTheme(theme)
    viewModel.addInspiration()
    
    // Then
    coVerify { repository.insertInspiration(match {
        it.content == content && it.themeName == theme.name
    }) }
}
```

**Repositoryæµ‹è¯•**
```kotlin
@Test
fun `getAllInspirations should return flow of inspirations`() = runTest {
    // Given
    val testInspirations = listOf(
        InspirationEntity(1, "å†…å®¹1", "ä¸»é¢˜1", 1000, 6),
        InspirationEntity(2, "å†…å®¹2", "ä¸»é¢˜2", 2000, 6)
    )
    coEvery { dao.getAllInspirations() } returns flowOf(testInspirations)
    
    // When
    val result = repository.getAllInspirations()
    
    // Then
    result.test {
        val inspirations = awaitItem()
        assertThat(inspirations).hasSize(2)
        assertThat(inspirations[0].content).isEqualTo("å†…å®¹1")
        cancel()
    }
}
```

#### 6.3.2 UIæµ‹è¯•

```kotlin
@Test
fun `inspiration card should display content and theme`() {
    composeTestRule.setContent {
        InspirationCard(
            content = "æµ‹è¯•çµæ„Ÿå†…å®¹",
            themeName = "å·¥ä½œ",
            createdAtText = "åˆšåˆš"
        )
    }
    
    composeTestRule.onNodeWithText("æµ‹è¯•çµæ„Ÿå†…å®¹").assertIsDisplayed()
    composeTestRule.onNodeWithText("å·¥ä½œ").assertIsDisplayed()
    composeTestRule.onNodeWithText("åˆšåˆš").assertIsDisplayed()
}
```

### 6.4 æ€§èƒ½ä¼˜åŒ–

#### 6.4.1 æ•°æ®åº“ä¼˜åŒ–

**ç´¢å¼•ä¼˜åŒ–**
```kotlin
@Entity(
    tableName = "inspirations",
    indices = [
        Index(value = ["content"]),      // æœç´¢ä¼˜åŒ–
        Index(value = ["theme_name"]),   // ä¸»é¢˜ç­›é€‰ä¼˜åŒ–
        Index(value = ["created_at"])    // æ’åºä¼˜åŒ–
    ]
)
```

**æŸ¥è¯¢ä¼˜åŒ–**
```kotlin
@Query("""
    SELECT * FROM inspirations 
    WHERE content LIKE '%' || :keyword || '%' 
    AND theme_name IN (:themes)
    AND created_at >= :startTime
    ORDER BY created_at DESC
    LIMIT :limit
""")
suspend fun searchInspirationsAdvanced(
    keyword: String,
    themes: List<String>,
    startTime: Long,
    limit: Int = 100
): List<InspirationEntity>
```

#### 6.4.2 UIæ€§èƒ½ä¼˜åŒ–

**åˆ—è¡¨ä¼˜åŒ–**
```kotlin
LazyColumn(
    modifier = Modifier.fillMaxSize(),
    contentPadding = PaddingValues(vertical = 8.dp),
    verticalArrangement = Arrangement.spacedBy(8.dp)
) {
    items(
        items = inspirations,
        key = { it.id }  // ä½¿ç”¨ç¨³å®škeyæå‡æ€§èƒ½
    ) { inspiration ->
        InspirationCard(
            content = inspiration.content,
            themeName = inspiration.themeName,
            createdAtText = formatTimeAgo(inspiration.createdAt),
            onClick = { /* å¤„ç†ç‚¹å‡» */ },
            onLongClick = { /* å¤„ç†é•¿æŒ‰ */ }
        )
    }
}
```

**åŠ¨ç”»ä¼˜åŒ–**
```kotlin
@Composable
fun InspirationCard(/* å‚æ•° */) {
    val scale = remember { Animatable(0.95f) }
    val alpha = remember { Animatable(0.8f) }
    
    LaunchedEffect(Unit) {
        // å¹¶è¡ŒåŠ¨ç”»æå‡æ€§èƒ½
        launch {
            scale.animateTo(1f, animationSpec = tween(300))
        }
        launch {
            alpha.animateTo(1f, animationSpec = tween(200))
        }
    }
}
```

#### 6.4.3 å†…å­˜ä¼˜åŒ–

**åç¨‹ä½œç”¨åŸŸç®¡ç†**
```kotlin
@HiltViewModel
class MainViewModel @Inject constructor(
    private val repository: InspirationRepository
) : ViewModel() {
    
    // ä½¿ç”¨viewModelScopeè‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸ
    private val _uiState = MutableStateFlow(MainUiState())
    val uiState: StateFlow<MainUiState> = _uiState.asStateFlow()
    
    override fun onCleared() {
        super.onCleared()
        // æ¸…ç†èµ„æº
    }
}
```

**èµ„æºæ¸…ç†**
```kotlin
@Composable
fun InspirationCard(/* å‚æ•° */) {
    val context = LocalContext.current
    
    DisposableEffect(Unit) {
        onDispose {
            // æ¸…ç†èµ„æº
        }
    }
}
```

---

## 7. éƒ¨ç½²å’Œå‘å¸ƒ

### 7.1 æ„å»ºé…ç½®

#### 7.1.1 APKè¾“å‡ºé…ç½®

```kotlin
android {
    // ... å…¶ä»–é…ç½®
    
    // é…ç½®APKè¾“å‡ºæ–‡ä»¶å
    applicationVariants.configureEach {
        outputs.configureEach {
            if (this is com.android.build.gradle.internal.api.ApkVariantOutputImpl) {
                val buildType = buildType.name
                outputFileName = when (buildType) {
                    "release" -> "sparkle-note.apk"
                    "debug" -> "sparkle-note-debug.apk"
                    else -> "sparkle-note-${buildType}.apk"
                }
            }
        }
    }
}
```

#### 7.1.2 ç‰ˆæœ¬ç®¡ç†

```kotlin
android {
    defaultConfig {
        applicationId = "com.sparkle.note"
        minSdk = 24
        targetSdk = 34
        versionCode = 1                    // å†…éƒ¨ç‰ˆæœ¬å·ï¼Œé€’å¢
        versionName = "1.0.0"              // ç”¨æˆ·å¯è§ç‰ˆæœ¬å·
        
        testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
        vectorDrawables {
            useSupportLibrary = true
        }
    }
}
```

### 7.2 æ„å»ºå‘½ä»¤

#### 7.2.1 å¼€å‘æ„å»º

```bash
# è°ƒè¯•ç‰ˆæœ¬
./gradlew assembleDebug

# å‘å¸ƒç‰ˆæœ¬
./gradlew assembleRelease

# æ¸…ç†å¹¶æ„å»º
./gradlew clean assembleRelease
```

#### 7.2.2 æµ‹è¯•æ„å»º

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
./gradlew test

# è¿è¡ŒUIæµ‹è¯•
./gradlew connectedAndroidTest

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
./gradlew jacocoTestReport
```

### 7.3 å‘å¸ƒæµç¨‹

#### 7.3.1 å‘å¸ƒå‰æ£€æŸ¥æ¸…å•

- [ ] æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥å®Œæˆ
- [ ] ç‰ˆæœ¬å·æ­£ç¡®æ›´æ–°
- [ ] æ›´æ–°æ—¥å¿—ç¼–å†™å®Œæˆ
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] å®‰å…¨æ‰«æé€šè¿‡

#### 7.3.2 å‘å¸ƒæ¸ é“

1. **Google Play Store** - ä¸»è¦å‘å¸ƒæ¸ é“
2. **GitHub Releases** - å¼€æºç‰ˆæœ¬å‘å¸ƒ
3. **å†…éƒ¨æµ‹è¯•** - å°èŒƒå›´æµ‹è¯•å‘å¸ƒ

#### 7.3.3 å‘å¸ƒåç›‘æ§

- å´©æºƒç‡ç›‘æ§
- ç”¨æˆ·åé¦ˆæ”¶é›†
- æ€§èƒ½æŒ‡æ ‡è·Ÿè¸ª
- ç‰ˆæœ¬è¿­ä»£è®¡åˆ’

---

## æ€»ç»“

Sparkle Note é¡¹ç›®å±•ç°äº†ç°ä»£ Android åº”ç”¨å¼€å‘çš„æœ€ä½³å®è·µï¼š

### ğŸ—ï¸ æ¶æ„ä¼˜åŠ¿
- **Clean Architecture**ï¼šæ¸…æ™°çš„åˆ†å±‚æ¶æ„ï¼ŒèŒè´£åˆ†ç¦»
- **MVVMæ¨¡å¼**ï¼šå“åº”å¼ç¼–ç¨‹ï¼ŒçŠ¶æ€ç®¡ç†æ¸…æ™°
- **ä¾èµ–æ³¨å…¥**ï¼šHiltå®ç°ï¼Œè§£è€¦å’Œå¯æµ‹è¯•æ€§å¼º

### ğŸ¨ è®¾è®¡äº®ç‚¹
- **Material Design 3**ï¼šç°ä»£åŒ–çš„è®¾è®¡è¯­è¨€
- **ä¸»é¢˜ç³»ç»Ÿ**ï¼š4ç§ç²¾ç¾ä¸»é¢˜ï¼Œæ”¯æŒæ·±è‰²æ¨¡å¼
- **å“åº”å¼UI**ï¼šé€‚é…ä¸åŒå±å¹•å°ºå¯¸å’Œè®¾å¤‡

### âš¡ æŠ€æœ¯ç‰¹è‰²
- **Jetpack Compose**ï¼šå£°æ˜å¼UIå¼€å‘
- **Kotlin Flow**ï¼šå“åº”å¼æ•°æ®æµ
- **Roomæ•°æ®åº“**ï¼šç±»å‹å®‰å…¨çš„æ•°æ®åº“è®¿é—®

### ğŸ“ˆ åŠŸèƒ½å®Œæ•´
- **çµæ„Ÿè®°å½•**ï¼šå¿«é€Ÿè®°å½•å’Œç®¡ç†
- **ä¸»é¢˜ç®¡ç†**ï¼šçµæ´»çš„ä¸»é¢˜åˆ†ç±»
- **æ™ºèƒ½æœç´¢**ï¼šå¤šç»´åº¦ç­›é€‰å’Œæœç´¢
- **æ•°æ®å¤‡ä»½**ï¼šå¤šç§æ ¼å¼å¯¼å‡ºå’Œå¤‡ä»½

è¿™ä¸ªé¡¹ç›®ä¸º Android åº”ç”¨å¼€å‘æä¾›äº†ä¸€ä¸ªä¼˜ç§€çš„å‚è€ƒå®ç°ï¼Œæ¶µç›–äº†ä»æ¶æ„è®¾è®¡åˆ°UIå®ç°ï¼Œä»åŠŸèƒ½å¼€å‘åˆ°æµ‹è¯•éƒ¨ç½²çš„å®Œæ•´å¼€å‘æµç¨‹ã€‚